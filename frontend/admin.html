<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>

<title>GBRSA Score â€¢ Admin</title>

<link rel="stylesheet" href="./styles.css">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0b1020">

<!-- IMPORTANT: LOAD CONFIG FIRST -->
<script defer src="./config.js"></script>
<script defer src="./app.js"></script>

<style>
  .admin-wrapper {
    max-width: 420px;
    margin: 0 auto;
    padding: 20px;
  }

  .admin-card {
    background: #fff;
    border-radius: 14px;
    padding: 24px;
    box-shadow: 0 4px 14px rgba(0,0,0,0.08);
  }

  .admin-card h2 {
    margin-top: 0;
    text-align: center;
    margin-bottom: 20px;
  }

  .admin-btn {
    width: 100%;
    margin: 10px 0;
    padding: 14px;
    font-size: 16px;
    border-radius: 10px;
  }
</style>

</head>

<body class="page">

<header class="topbar" style="display:flex;align-items:center;gap:12px;padding:12px 16px;">
  <img src="./assets/company-logo.png" alt="GBRSA" class="logo" style="height:38px;">
  <div class="titles">
    <h1>Admin Panel</h1>
    <p class="subtitle">GBRSA Scoring System</p>
  </div>
</header>

<main class="admin-wrapper">
  <div class="admin-card">

    <h2>Admin Menu</h2>

    <button class="btn primary admin-btn" onclick="location.href='speed.html'">
      Speed Event
    </button>

    <button class="btn primary admin-btn" onclick="location.href='freestyle.html'">
      Freestyle Event
    </button>

    <!-- ðŸ”¥ FORCE LOGOUT BUTTON -->
    <button class="btn danger admin-btn" onclick="forceLogoutAll()">
      Force Logout All Judges
    </button>

    <button class="btn danger admin-btn" onclick="logoutAdmin()">
      Logout (Admin)
    </button>

  </div>
</main>

<footer class="foot" style="text-align:center; margin-top:30px;">
  <small>Â© 2025 GB Rope Skipping Academy</small>
</footer>

<!-- ===================================================
     ADMIN LOGOUT + FORCE LOGOUT API (NO POPUP VERSION)
     =================================================== -->
<script>
function logoutAdmin() {
  window.location.href = "index.html";
}

async function forceLogoutAll() {

    // Ensure config exists
    if (!window.CONFIG || !window.CONFIG.APPS_SCRIPT_URL) {
        console.error("CONFIG not loaded");
        return;
    }

    const url = window.CONFIG.APPS_SCRIPT_URL + "?cmd=forceLogout";

    try {
        const res = await fetch(url, { cache: "no-store" });
        const js = await res.json();

        if (js && js.ok) {
            // SILENT SUCCESS â€” NO POPUP
            console.log("All judges forced to logout. Version =", js.logoutVersion);
        } else {
            console.error("Force logout error:", js.error);
        }

    } catch (e) {
        console.error("Force logout network error:", e);
    }
}
</script>

</body>
</html>
