<script>
// ============================
// LOAD KEY GROUPS
// ============================
const judgeKeys = window.JUDGE_KEYS;   // from config.js
const adminKeys = window.ADMIN_KEYS;   // you must add this in config.js

// UI elements
const keyInput  = document.getElementById("judgeKey");
const keyError  = document.getElementById("keyError");
const btnLogin  = document.getElementById("btnJudgeLogin");

// ============================
// LOGIN HANDLER
// ============================
btnLogin.addEventListener("click", () => {
  const key = keyInput.value.trim();

  keyError.style.display = "none";

  // ðŸ” ADMIN LOGIN â†’ admin.html
  if (adminKeys[key]) {
    btnLogin.disabled = true;
    btnLogin.textContent = "Loadingâ€¦";
    location.href = `admin.html?key=${key}`;
    return;
  }

  // ðŸ‘¨â€âš–ï¸ JUDGE LOGIN â†’ station.html
  const station = judgeKeys[key];
  if (station) {
    btnLogin.disabled = true;
    btnLogin.textContent = "Loadingâ€¦";
    location.href = `station.html?station=${station}&key=${key}`;
    return;
  }

  // âŒ INVALID KEY
  keyError.style.display = "block";
});

// Enter key = Login
keyInput.addEventListener("keyup", e => {
  if (e.key === "Enter") btnLogin.click();
});

// ============================
// RESET FIELDS ON RETURN
// ============================
function resetJudgeLogin() {
  keyInput.value = "";
  keyError.style.display = "none";
  btnLogin.disabled = false;
  btnLogin.textContent = "Enter";
}

// iOS â€” restores from cache
window.addEventListener("pageshow", resetJudgeLogin);

// Android â€” back/forward navigation
document.addEventListener("visibilitychange", () => {
  if (document.visibilityState === "visible") resetJudgeLogin();
});

// Extra safety
window.addEventListener("pagehide", resetJudgeLogin);
</script>
