<script>
// ============================
// LOAD KEY GROUPS FROM config.js
// ============================
const judgeKeys = window.JUDGE_KEYS || {};
const adminKeys = window.ADMIN_KEYS || {};

// UI elements
const keyInput  = document.getElementById("judgeKey");
const keyError  = document.getElementById("keyError");
const btnLogin  = document.getElementById("btnJudgeLogin");

// ============================
// LOGIN HANDLER
// ============================
btnLogin.addEventListener("click", () => {
  const key = keyInput.value.trim();
  keyError.style.display = "none";

  // ðŸ” ADMIN LOGIN â†’ admin.html
  if (adminKeys[key]) {
    btnLogin.disabled = true;
    btnLogin.textContent = "Loadingâ€¦";
    location.href = `admin.html?key=${encodeURIComponent(key)}`;
    return;
  }

  // ðŸ‘¨â€âš–ï¸ JUDGE LOGIN â†’ station.html
  const station = judgeKeys[key];
  if (station) {
    btnLogin.disabled = true;
    btnLogin.textContent = "Loadingâ€¦";
    location.href = `station.html?station=${station}&key=${encodeURIComponent(key)}`;
    return;
  }

  // âŒ INVALID KEY
  keyError.style.display = "block";
});

// ENTER key = login
keyInput.addEventListener("keyup", e => {
  if (e.key === "Enter") btnLogin.click();
});

// ============================
// RESET INPUT WHEN RETURNING
// ============================
function resetLoginField() {
  keyInput.value = "";
  keyError.style.display = "none";
  btnLogin.disabled = false;
  btnLogin.textContent = "Enter";
}

// iOS Safari restore
window.addEventListener("pageshow", resetLoginField);

// Android + Chrome restore
document.addEventListener("visibilitychange", () => {
  if (document.visibilityState === "visible") resetLoginField();
});

// Extra safety
window.addEventListener("pagehide", resetLoginField);
</script>
